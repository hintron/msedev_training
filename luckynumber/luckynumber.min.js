//
//// Display Code
//

document.addEventListener("DOMContentLoaded", function(event) {
    document.querySelector("#check-answer-btn").addEventListener("click", output_lucky_number);
    generate_lut();
});

function output_lucky_number() {
    var user_input = document.querySelector('#user_input').value;
    if(user_input == ""){
        document.querySelector('#lucky_number').textContent = "Input was null...";
        return;
    }

    // convert input into a number
    user_input = +user_input;
    if(!Number.isInteger(user_input)){
        document.querySelector('#lucky_number').textContent = "Input was not an integer...";
        return;
    }

    if(user_input > 777777777) {
        document.querySelector('#lucky_number').textContent = "Input was too big. Must be a 32-bit 2's compliment number";
        return;
    }

    lucky_number = getLuckyNumber(user_input);

    if(lucky_number){
        document.querySelector('#lucky_number').textContent = lucky_number;
    }
    else {
        document.querySelector('#lucky_number').textContent = "Could not find the lucky number...";
    }
}


//
//// Lucky Number code
//

const MAX_DIGITS = 9;
var lut = [];
var masks = [];
function generate_lut() {
    for (var i = 0; i < MAX_DIGITS; i++) {
        var num = 1 << i;
        masks.push(num);
    }
    for (var digit_number = 1; digit_number <= MAX_DIGITS; digit_number++) {
        var generate_count = 1 << (digit_number);
        for (var i = 0; i < generate_count; i++) {
            var strArray = [];
            for(var j = 0; j < digit_number; j++){
                strArray[j] = ((masks[j] & i)) ? "7" : "4";
            }
            var str = "";
            for (var k = strArray.length-1; k >= 0; k--) {
                str += strArray[k];
            }
            lut.push(~~str);
        }
    }
}
function getLuckyNumber(input){
    for (var i = 0; i < lut.length; i++) {
        if(input <= lut[i]){
            return lut[i];
        }
    }
}



